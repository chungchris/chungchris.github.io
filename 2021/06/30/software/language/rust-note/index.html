<!DOCTYPE HTML>
<html lang="zh-TW">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="rust,coding,programming">
    <meta name="description" content="A nontypical software engineer">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Rust ç­†è¨˜ | A Po</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="A Po" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">A Po</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Home</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories/software/" class="waves-effect waves-light">
      
      <i class="fas fa-laptop-code" style="zoom: 0.6;"></i>
      
      <span>Software</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories/travel/" class="waves-effect waves-light">
      
      <i class="fas fa-plane" style="zoom: 0.6;"></i>
      
      <span>Travelling</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories/taiwan/" class="waves-effect waves-light">
      
      <i class="fas fa-shoe-prints" style="zoom: 0.6;"></i>
      
      <span>Taiwan</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories/sketch/" class="waves-effect waves-light">
      
      <i class="fas fa-pencil-alt" style="zoom: 0.6;"></i>
      
      <span>Sketch</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">A Po</div>
        <div class="logo-desc">
            
            A nontypical software engineer
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Home
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories/software/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-laptop-code"></i>
			
			Software
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories/travel/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-plane"></i>
			
			Travelling
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories/taiwan/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-shoe-prints"></i>
			
			Taiwan
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories/sketch/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-pencil-alt"></i>
			
			Sketch
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://drive.google.com/uc?export=view&id=1bmeIr1XQxPCSWgI67fw4v9ubbKu-NlaQ')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Rust ç­†è¨˜</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/programming-language/">
                                <span class="chip bg-color">programming language</span>
                            </a>
                        
                            <a href="/tags/rust/">
                                <span class="chip bg-color">rust</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/software/" class="post-category">
                                software
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-06-30
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2022-10-21
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    7.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    38 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        
        <!-- ä»£ç å—æŠ˜è¡Œ -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="å­¸ç¿’é †åº"><a href="#å­¸ç¿’é †åº" class="headerlink" title="å­¸ç¿’é †åº"></a>å­¸ç¿’é †åº</h2><p>Rust æ˜¯ä¸€å€‹å­¸ç¿’æ›²ç·šæ¯”è¼ƒé™¡å³­çš„èªè¨€ï¼Œå³ä½¿æœ‰å…¶ä»–èªè¨€åŸºç¤ï¼Œå¦‚æœæ²’æœ‰å…ˆè®€æ›¸ï¼Œè€Œæ˜¯ç›´æ¥ä¸Šï¼Œé‚£åœ¨ compile éšæ®µå°±æœƒæœ‰å¾ˆå¤šæŒ«æŠ˜ä¸¦ä¸”ç„¡æ³•ç†è§£ã€‚ä»¥ä¸‹æ˜¯æˆ‘è¦ºå¾—å°å·²ç¶“æœ‰å…¶ä»–èªè¨€åŸºç¤çš„äººï¼Œç”¨é€™æ¨£çš„å­¸ç¿’é †åºæ˜¯ä¸éŒ¯çš„</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://tourofrust.com/TOC_zh-tw.html">Rust èªè¨€ä¹‹æ—…</a>ï¼š1 - 3 å¤©å°±å¯ä»¥èµ°å®Œï¼Œä¸¦ä¸”å› ç‚ºæ˜¯ä½¿ç”¨ playgroundï¼Œå¯ä»¥åŒæ™‚æ”¹æ”¹ä»–çš„ç¯„ä¾‹é¡å¤–è§€å¯Ÿä¸€äº›è‡ªå·±æœ‰èˆˆè¶£çš„è¡Œç‚ºã€‚èµ°å®Œä¹‹å¾Œå¤§æ¦‚æœƒå°æ–¼ Rust èˆ‡å…¶ä»–èªè¨€çš„å·®åˆ¥æœ‰äº›æ„Ÿè¦º</li>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/">Rust book</a>ï¼šOffical çš„æ•™å­¸æ–‡ï¼Œé›–ç„¶å¯«çš„ä¸ç®—ç‘£ç¢ï¼Œä½†è‹¥ä¸€é–‹å§‹å°±çœ‹é€™å€‹å¯èƒ½é‚„æ˜¯æœƒè®“äººå¤±å»è€å¿ƒï¼Œç•¢ç«Ÿä¸€æ¬¡æœƒç´¯ç¸¾æ¥æ”¶å¤ªå¤šæ–°æ±è¥¿ã€‚å¦‚æœå·²ç¶“æœ‰äº†æ­¥é©Ÿ 1ï¼Œå°æ–¼ Rust è·Ÿå…¶ä»–èªè¨€çš„ç•°åŒæœ‰æ„Ÿè¦ºï¼Œé‚£å¾ˆå¤šéƒ¨åˆ†å°±å¯ä»¥åƒç…§å…¶ä»–æœ¬ä¾†å°±æœƒçš„èªè¨€ï¼Œå› æ­¤æœ‰ä¸€å€‹ç«‹è¶³é»ï¼Œæ¯”è¼ƒä¸æœƒå¤ªæŒ«æŠ˜ä¸¦å¤±å»è€å¿ƒã€‚ä¸ä¸€å®šè¦ä¸€è¡Œä¸€è¡Œçœ‹çš„å¾ˆä»”ç´°ï¼Œå› ç‚ºå…¶å¯¦ç•¢ç«Ÿå…‰çœ‹ä¹ŸæœƒçœŸçš„æ‡‚ï¼Œæ‰€ä»¥å°±åªæ˜¯å¤§æ¦‚çŸ¥é“æœ‰å“ªäº›æ±è¥¿æœ‰å€‹å°è±¡å°±è¡Œã€‚å¯èƒ½æœƒèŠ±åˆ°ä¸€é€±ä»¥ä¸Šçš„æ™‚é–“ï¼Œå–æ±ºæ–¼çœ‹å¾—å¤šä»”ç´°ä»¥åŠå¤šä¹…å¤±å»è€å¿ƒâ€¦ å’Œä¸‹ä¸€æ­¥çš„ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a> é †åºå¯èƒ½å¯ä»¥èª¿æ›ï¼Œçœ‹ä½ çš„ç¿’æ…£æ˜¯æ¯”è¼ƒå–œæ­¡è®€æ›¸é‚„æ˜¯çœ‹ codeâ€¦ï¼Œå¦‚æœå¾ˆä¸æ„›è®€æ–‡å­—çš„è©±ç”šè‡³ä¹Ÿå¯ä»¥è·³é Rust bookï¼Œç›´æ¥å¾ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a> é–‹å§‹ä¹Ÿå¯ä»¥ï¼Œå¦‚æœæœ‰ Example çœ‹ä¸æ‡‚çš„åœ°æ–¹å†ä¾†ç¿»ç¿»çœ‹ Rust book</li>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a>ï¼šä¸€äº›åŸºç¤ pattern çš„ç¯„ä¾‹ï¼Œå¯ä»¥ç†Ÿæ‚‰ Rust èªæ³•å’Œä»–çš„ä¸€äº›ç‰¹åˆ¥è¨­è¨ˆï¼Œå°¤å…¶å¦‚ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/custom_types/enum/testcase_linked_list.html">Enum</a>ã€<code>match</code>ã€<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/fn/closures.html">Closure</a>â€¦ ç­‰ç­‰å…¶ä»–èªè¨€å¯èƒ½ä¹Ÿæœ‰ï¼Œä½† Rust å»åœ¨å…¶ä¸ŠèŠ±æ›´å¤šåŠŸå¤«çš„éƒ¨åˆ†ã€‚å…¨éƒ¨å¤§æ¦‚ 3 å¤©ä»¥å…§å¯ä»¥çœ‹å®Œã€‚å¦‚æœæœ‰ç„¡æ³•ç†è§£çš„åœ°æ–¹ï¼Œå¯èƒ½é‚„æ˜¯è¦å›å»ç¿» <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/">Rust book</a></li>
</ol>
<p>åˆ°é€™è£¡å°±çµæŸäº†è®€æ›¸éšæ®µï¼Œç¸½å…±èŠ±äº† 1~2 é€±çš„æ™‚é–“ï¼Œå¾€ä¸‹å°±æ˜¯ç·´ç¿’äº†</p>
<ol start="4">
<li><a target="_blank" rel="noopener" href="https://cheats.rs/">Chest sheet</a>ï¼šå¯ä»¥é–‹å§‹ä¸Šå·¥äº†ï¼Œå­¸ç¿’èªè¨€é€™ç¨®æ±è¥¿æ˜¯æ²’è¾¦æ³•åªç”¨çœ‹çš„ï¼Œé–‹å§‹è‘—æ‰‹å¯« project æ‰èƒ½çœŸçš„å­¸æœƒï¼Œå¯«çš„éç¨‹å°±å¯ä»¥å¿«é€Ÿç”¨é€™å€‹ Chest sheet æŸ¥çœ‹èªæ³•ï¼Œå¤§éƒ¨åˆ†åœ¨ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a> ä»‹ç´¹åˆ°çš„ pattern éƒ½æœ‰è¢«ä»¥ä¸€è¡Œç°¡æ½”çš„æ”¶éŒ„åœ¨ Chest sheetï¼Œåéä¾†èªªï¼Œè‹¥çœ‹äº† Chest sheet é‚„æ˜¯æœ‰ç–‘æƒ‘ï¼Œå¯ä»¥å›å»ç¿» <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rust-lang/rustlings/">rustlings</a>ï¼šRust å®˜æ–¹æä¾›çš„ç·´ç¿’ï¼Œå¯ä»¥é–‹å§‹ç·´ç¿’å°ç¨‹å¼ï¼Œç¯„åœæœ‰å¯èƒ½æ˜¯å–®ä¸€ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a>ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è¤‡åˆã€‚å…¶å¯¦ rustlings åŸºæœ¬ä¸Šå°±æ˜¯ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a>ï¼Œåªæ˜¯ä¹‹å‰ Rust by Example ä½ å¯èƒ½å°±åªæ˜¯å…‰çœ‹ï¼Œé€é rustlings ä½ å¯ä»¥çœŸçš„å‹•æ‰‹å¯«ä¸€æ¬¡ï¼Œéç¨‹ä¸­ <a target="_blank" rel="noopener" href="https://cheats.rs/">Chest sheet</a> å°±æ˜¯å¥½å¹«æ‰‹</li>
<li><a target="_blank" rel="noopener" href="https://rust-algo.club/index.html">Rust Algorithm Club</a>ï¼šåŸºç¤æ¼”è¡£æ–™çµæ§‹å’Œç®—æ³•çš„å¯¦ä½œ</li>
<li><a target="_blank" rel="noopener" href="https://rust-lang-nursery.github.io/rust-cookbook/">Rust cookbook</a>ï¼šå®Œæˆä¹‹å‰çš„æ­¥é©Ÿä¹‹å¾Œï¼Œä½ åŸºæœ¬ä¸Šå·²ç¶“å¯ä»¥ç”¨ Rust å®Œæˆå¤§éƒ¨åˆ†çš„éœ€æ±‚ï¼Œä½†å¯ä»¥é€²ä¸€æ­¥å†è®€é€™å€‹ Rust cookbookã€‚ä»–æ˜¯å®˜æ–¹æ”¶é›†äº†å¸¸ç”¨çš„æƒ…å¢ƒï¼Œç¤ºç¯„æœ€å°ˆæ¥­çš„å¯«æ³•ã€‚åœ¨å¾€å¾Œä½ çš„å¯¦éš›å°ˆæ¡ˆä¸­ï¼Œä½ çš„ç¨‹å¼çš„éœ€æ±‚ä¸€å®šéƒ½ç”¨å¾—åˆ°é€™äº›æ±è¥¿ï¼Œä¹Ÿå°±æ˜¯èªªç•¶æˆç‚ºä¸€å€‹è·æ¥­ Rust developerï¼Œ<a target="_blank" rel="noopener" href="https://cheats.rs/">Chest sheet</a>ã€<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a>ã€<a target="_blank" rel="noopener" href="https://rust-lang-nursery.github.io/rust-cookbook/">Rust cookbook</a> å°±æ˜¯ä¸‰å€‹é–‹åœ¨æ—é‚Šéš¨æ™‚åƒè€ƒçš„æ±è¥¿ã€‚å…¶å¯¦ï¼Œå¦‚æœæ˜¯å…¶ä»–èªè¨€ï¼Œç•¶æƒ³æ‰¾ä»€éº¼èªæ³•æˆ‘å€‘å¯èƒ½éƒ½æœƒé¸æ“‡ç›´æ¥ Googleï¼Œç„¶å¾Œå°±æœƒçœ‹åˆ°åå‡º Stack Overflow çš„çµæœå¯ä»¥ç›´æ¥åƒè€ƒï¼Œä¸éå¯èƒ½ Rust æ˜¯ä¸€å€‹ç›¸å°æ–°çš„èªè¨€ï¼ŒåŠ ä¸Šä»–çš„å­¸ç¿’æ›²ç·šæ¯”è¼ƒé™¡å³­ï¼Œæ‰€ä»¥ Stack Overflow çš„å›ç­”å¯èƒ½æœƒå‡ºç¾ä¸å¤ªæ­£ç¢ºæˆ–è€…éæ–¼æ¨¡ç³Šçš„ç‹€æ³ï¼Œæ‰€ä»¥æ‰å»ºè­°å¾å®˜æ–¹è³‡æºå‡ºç™¼ï¼Œæ‰å¯¦ä¸€é»çš„å­¸ï¼Œå¾€å¾Œå°±å¯ä»¥æ›´æœ‰èƒ½åŠ›åˆ¤æ–·åˆ¥äººçš„å›ç­”æ˜¯å°æ˜¯éŒ¯ã€‚ä¹Ÿä¸ç”¨å…¨çœ‹å•¦ï¼Œç€è¦½ä¸€ä¸‹ä»–æœ‰å“ªäº›ç¯„ä¾‹ï¼Œç„¶å¾ŒæŒ‘å¹¾å€‹æœ‰èˆˆè¶£çœ‹ä¸€ä¸‹å°±å¯ä»¥ï¼Œä¹‹å¾ŒçœŸçš„é–‹å§‹å¯«å°ˆæ¡ˆï¼Œè¦ä¾†è¤‡è£½è²¼ä¸Šçš„æ™‚å€™ï¼Œå†ä¾†æŠŠä»–çœ‹æ‡‚å°±å¯ä»¥</li>
<li>å¦å¤–ä¹Ÿæœ‰éå®˜æ–¹çš„ç·´ç¿’å¦‚ <a target="_blank" rel="noopener" href="https://exercism.io/my/tracks/rust">Exercism</a> æä¾›æ›´é€²éšçš„é¡Œç›®ã€‚LeetCode ä¹Ÿæœ‰ Rust å•¦ï¼Œä¸éä»–ç•¢ç«Ÿä¸»è¦æ˜¯ for é¢è©¦æƒ…å¢ƒï¼Œæ‰€ä»¥æ˜¯ä»¥æ€è€ƒæ¼”ç®—æ³•ç‚ºä¸»è¦å°å‘çš„ï¼Œå› æ­¤ç”¨é«˜éšä¸€é»çš„èªè¨€å»åˆ·æ¯”å¦‚ Python, Java é‚„æ˜¯æ¯”è¼ƒé©åˆçš„ã€‚Rust ä½œç‚ºä¸€å€‹ system programming languageï¼Œç›´æ¥ç”¨å®ƒä¾†é–‹å§‹å¯« system application å°±å¾ˆå¥½</li>
<li>å¯ä»¥é–‹å§‹å¯«å®Œæ•´çš„ project äº†ï¼Œå¦‚æœæ²’æœ‰ä¸»é¡Œçš„è©±ï¼Œå¯ä»¥å¾ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/ch20-00-final-project-a-web-server.html">Rust book å»ºè­°çš„</a> é–‹å§‹</li>
</ol>
<hr>
<h2 id="Chest-sheet"><a href="#Chest-sheet" class="headerlink" title="Chest sheet"></a>Chest sheet</h2><p><a target="_blank" rel="noopener" href="https://cheats.rs/">Chest sheet</a></p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a></li>
<li><a target="_blank" rel="noopener" href="https://rust-lang-nursery.github.io/rust-cookbook/">Rust cookbook</a> </li>
<li><a target="_blank" rel="noopener" href="https://rust-algo.club/index.html">Rust Algorithm Club</a></li>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/">Official std</a></li>
</ul>
<h3 id="Data-Type"><a href="#Data-Type" class="headerlink" title="Data Type"></a>Data Type</h3><h4 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h4><ul>
<li><p>integer</p>
<blockquote>
<p>Length	Signed	Unsigned<br>8-bit	    <code>i8</code>	<code>u8</code><br>16-bit	<code>i16</code>	<code>u16</code><br>32-bit	<code>i32</code>(default)	<code>u32</code><br>64-bit	<code>i64</code>	<code>u64</code><br>128-bit	<code>i128</code>	<code>u128</code><br>arch	<code>isize</code>	<code>usize</code></p>
</blockquote>
</li>
<li><p>float: <code>f32</code>, <code>f64</code>(default)</p>
</li>
<li><p><code>bool</code></p>
</li>
<li><p><code>char</code>: Fixed 4 bytes in size and represents a Unicode Scalar Value</p>
</li>
</ul>
<h4 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h4><ul>
<li><strong>Tuple</strong>: <code>()</code> Fixed length. Group different types.</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tup<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> tup<span class="token punctuation">;</span> <span class="token comment">// it's copying, not moving because it's on stack</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> five_hundred <span class="token operator">=</span> x<span class="token number">.0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> six_point_four <span class="token operator">=</span> x<span class="token number">.1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>Array</strong>: <code>[]</code> Same type. Fixed length</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> a<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">i32</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//[3 ,3 ,3, 3, ,3]</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> first <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> second <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><a href="https://chungchris.github.io/2021/06/30/software/language/rust-note/#toc-heading-18">Vector</a></p>
</li>
<li><p><a href="https://chungchris.github.io/2021/06/30/software/language/rust-note/#toc-heading-12">string</a></p>
</li>
<li><p><a href="https://chungchris.github.io/2021/06/30/software/language/rust-note/#toc-heading-19">HashMap</a></p>
</li>
</ul>
<hr>
<blockquote>
<p>å¾€ä¸‹æ˜¯æˆ‘è‡ªå·±è£œå…… Chest sheet ä¸­æ²’æœ‰çš„ï¼Œæˆ–è€…ä¸€äº›æ¯”è¼ƒé›£æ‡‚çš„æ¦‚å¿µ</p>
</blockquote>
<h2 id="Borrowing"><a href="#Borrowing" class="headerlink" title="Borrowing"></a>Borrowing</h2><p>Rust çš„ <code>*</code> å’Œ <code>&amp;</code> åœ¨ä¸€é–‹å§‹ä¸å»ºè­°ç›´æ¥ç”¨ C çš„æ–¹å¼ä¾†ç†è§£ï¼Œè€Œå»ºè­°ç†è§£ç‚º <code>&amp;</code> è¡¨é”çš„æ˜¯ <code>å€Ÿç”¨</code>ï¼Œè€Œä¸æ˜¯ <code>å–å€</code>ã€‚<br>é›–ç„¶å…¶å¯¦åŸºç¤ä¸Šå°±éƒ½æ˜¯ referenceï¼Œæ‰€ä»¥ä»¥åº•å±¤ä¾†èªªå¯¦éš›ä¸Šè·Ÿ C å·®ç•°ä¸å¤§ï¼Œåªæ˜¯èªæ³•ä¸Šå¦‚æœç›´æ¥æƒ³æˆè·Ÿ C ä¸€æ¨£ï¼Œé‚£æœƒæœ‰å¥½äº› compile error ç„¡æ³•é †åˆ©ç†è§£ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Foo</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">do_something</span><span class="token punctuation">(</span>f<span class="token punctuation">:</span> <span class="token class-name">Foo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// f is dropped here</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> foo <span class="token operator">=</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> foo<span class="token punctuation">;</span>

    <span class="token comment">// FAILURE: do_something(foo) would fail because</span>
    <span class="token comment">// foo cannot be moved while mutably borrowed</span>

    <span class="token comment">// FAILURE: foo.x = 13; would fail here because</span>
    <span class="token comment">// foo is not modifiable while mutably borrowed</span>

    f<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>
    <span class="token comment">// f is dropped here because it's no longer used after this point</span>
    
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> foo<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// this works now because all mutable references were dropped</span>
    foo<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
    
    <span class="token comment">// move foo's ownership to a function</span>
    <span class="token function">do_something</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>Rust åªå…è¨± ä¸€å€‹ mut reference æˆ–è€… å¤šå€‹ unmut referenceï¼Œä½†ä¸æœƒåŒæ™‚ç™¼ç”Ÿ</li>
<li>ä¸€å€‹ reference çµ•å°ä¸èƒ½æ´»å¾—æ¯”å®ƒçš„æ“æœ‰è€…é‚„é•·</li>
</ul>
<p>å°æ–¼å€Ÿç”¨è€Œä¾†çš„è®Šæ•¸ï¼Œæ“ä½œæ™‚æœƒä½¿ç”¨åˆ° <code>*</code>ï¼Œé›–ç„¶ä¹Ÿå«åš <code>dereferencing</code>ï¼Œä½†åœ¨ rust ä¾†èªªä¸€æ¨£æ˜¯è¦ç”¨ ownership çš„æ¦‚å¿µä¾†æº–ç¢ºç†è§£ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> foo <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> foo<span class="token punctuation">;</span>
    <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token operator">*</span>f<span class="token punctuation">;</span> <span class="token comment">// get a copy of the owner's value</span>
    <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>      <span class="token comment">// set the reference's owner's value</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> bar<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ³¨æ„ <code>let bar = *f</code> æ˜¯è®“ bar å¾—åˆ° f çš„å€¼çš„è¤‡è£½å“ï¼Œå‰ææ˜¯ f çš„å‹åˆ¥æœ‰ Copy å±¬æ€§ã€‚</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Borrow checker å…¶å¯¦æ˜¯å€‹å¤§é­”ç‹ï¼Œä»–éå¸¸åš´æ ¼ï¼Œå¯ä»¥å¯«å¯«é€™ä¸€é¡Œä¾‹å­å°±æœƒæ›´æœ‰æ„Ÿè¦º<br><a href="https://chungchris.github.io/2021/07/09/software/leecode/Remove-Nth-Node-From-End-of-List/#toc-heading-5">[LeeCode] #19 Remove Nth Node From End of List</a></p>
<hr>
<h2 id="Lifetime"><a href="#Lifetime" class="headerlink" title="Lifetime"></a>Lifetime</h2><p>Lifetime å°±æ˜¯ç‚ºäº† borrow checker è€Œå­˜åœ¨ï¼Œç¢ºä¿ä¸€å€‹ reference ä¸€å®šä¸æœƒ refer åˆ°ä¸€å¡Šå·²ç¶“æ­»æ‰çš„å¯¦é«”ã€‚å¤§éƒ¨åˆ†çš„ç‹€æ³éƒ½ Elisionï¼Œç·¨è­¯å™¨æœƒå¹«å¿™è£œä¸Šï¼Œä½†ç·¨è­¯å™¨ç„¡æ³•åˆ¤æ–·çš„ç‹€æ³è‡ªç„¶å°±è¦è‡ªå·±å¯«</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// `print_refs` takes two references to `i32` which have different</span>
<span class="token comment">// lifetimes `'a` and `'b`. These two lifetimes must both be at</span>
<span class="token comment">// least as long as the function `print_refs`.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">print_refs</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'b</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'b</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"x is {} and y is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// A function which takes no arguments, but has a lifetime parameter `'a`.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">failed_borrow</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _x <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>

    <span class="token comment">// ERROR: `_x` does not live long enough</span>
    <span class="token keyword">let</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">i32</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>_x<span class="token punctuation">;</span>
    <span class="token comment">// Attempting to use the lifetime `'a` as an explicit type annotation </span>
    <span class="token comment">// inside the function will fail because the lifetime of `&amp;_x` is shorter</span>
    <span class="token comment">// than that of `y`. A short lifetime cannot be coerced into a longer one.</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create variables to be borrowed below.</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>four<span class="token punctuation">,</span> nine<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Borrows (`&amp;`) of both variables are passed into the function.</span>
    <span class="token function">print_refs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>four<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nine<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Any input which is borrowed must outlive the borrower. </span>
    <span class="token comment">// In other words, the lifetime of `four` and `nine` must </span>
    <span class="token comment">// be longer than that of `print_refs`.</span>
    
    <span class="token function">failed_borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// `failed_borrow` contains no references to force `'a` to be </span>
    <span class="token comment">// longer than the lifetime of the function, but `'a` is longer.</span>
    <span class="token comment">// Because the lifetime is never constrained, it defaults to `'static`.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>fn failed_borrow&lt;'a&gt;()</code> ä»£è¡¨ <code>'a</code> é€™å€‹ lifetime è¦ &gt;= <code>failed_borrow()</code> é€™å€‹ funtcion çš„ lifetime<br>ä½† <code>main()</code> è£¡é¢å‘¼å«åˆ° <code>failed_borrow()</code> çš„æ™‚å€™ï¼Œæ²’æœ‰æŒ‡å®š <code>'a</code> æ˜¯ä»€éº¼ï¼Œé‚£å°±é è¨­ <code>'a</code> å°±æ˜¯ <code>'static</code>ï¼Œè€Œ <code>'static</code> é€™å€‹ lifetime ä¸€å®š &gt;= <code>failed_borrow()</code> çš„ lifetime</p>
<p><code>fn print_refs&lt;'a, 'b&gt;(x: &amp;'a i32, y: &amp;'b i32)</code> è¦ç¯„ <code>print_refs()</code> é€™å€‹ function çš„ lifetimeï¼Œä¸€å®šè¦ &lt;= <code>'a</code>,<code>'b</code> é€™å…©å€‹ lifetimeï¼Œä¹Ÿå°±æ˜¯ä»–çš„å…©å€‹åƒæ•¸çš„ lifetime</p>
<h3 id="Coercion"><a href="#Coercion" class="headerlink" title="Coercion"></a>Coercion</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// Here, Rust infers a lifetime that is as short as possible.</span>
<span class="token comment">// The two references are then coerced to that lifetime.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">multiply</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>first<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> second<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    first <span class="token operator">*</span> second
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>first</code> <code>second</code> å…©å€‹åƒæ•¸çš„ lifetime ä¸è¦‹å¾—ç›¸åŒï¼Œä½†æœƒå–å…¶å°è€…ï¼Œæœ‰å°±æ˜¯ <code>multiply()</code> é€™å€‹ function çš„ lifetime ä¸€å®šè¦å°æ–¼ç­‰æ–¼å…¶å…©å€‹åƒæ•¸ä¹‹ä¸­ lifetime æ›´å°çš„é‚£å€‹</p>
<h3 id="static"><a href="#static" class="headerlink" title="static"></a>static</h3><ul>
<li>ä¸€å€‹éœæ…‹è®Šé‡æ˜¯åœ¨ç·¨è­¯æ™‚é–“å°±è¢«ç”¢ç”Ÿçš„è¨˜æ†¶é«”è³‡æºï¼Œå®ƒå¾ç¨‹å¼ä¸€é–‹å§‹å°±å­˜åœ¨ï¼Œç›´åˆ°çµæŸ</li>
<li>ä¸€å®šè¦æ˜ç¢ºçš„è¡¨ç¤ºå‹åˆ¥</li>
<li>æ°¸é ä¸æœƒè¢« <code>drop</code></li>
<li>å¦‚æœéœæ…‹ç”Ÿå‘½é€±æœŸè³‡æºåŒ…å«äº† referenceï¼Œé‚£å®ƒå€‘å¿…é ˆéƒ½å¾—æ˜¯ <code>static</code></li>
</ul>
<br>

<ul>
<li>ä¿®æ”¹éœæ…‹è®Šé‡æœ¬è³ªä¸Šå°±æ˜¯å±éšªçš„ï¼Œå› ç‚ºä»»ä½•äººåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å­˜å–å®ƒå€‘ï¼Œè€Œé€™æœ‰å¯èƒ½æœƒé€ æˆ data racing</li>
<li>Rust å…è¨±ä½¿ç”¨ <code>unsafe { ... }</code> æ“ä½œä¸€äº›ç·¨è­¯å™¨ç„¡æ³•ç¢ºä¿çš„è¨˜æ†¶é«”è¡Œç‚º</li>
</ul>
<hr>
<h2 id="Collections-string"><a href="#Collections-string" class="headerlink" title="Collections- string"></a>Collections- string</h2><p><code>utf-8</code>ï¼Œæœ‰ 1-4 å€‹ bytes çš„<em>å¯è®Šé•·åº¦</em></p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">"hi ğŸ¦€"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> first_word <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 2 bytes =&gt; 2 Eng chars</span>
    <span class="token keyword">let</span> second_word <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 4 bytes =&gt; 1 emoji</span>
    <span class="token comment">// let half_crab = &amp;a[3..5]; FAILS</span>
    <span class="token comment">// Rust does not accept slices of invalid unicode characters</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} {}"</span><span class="token punctuation">,</span> first_word<span class="token punctuation">,</span> second_word<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">7</span>
hi ğŸ¦€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å› ç‚ºå¯è®Šé•·åº¦çš„é—œä¿‚ï¼ŒæŸ¥æ‰¾å­—å…ƒæ™‚ç„¡æ³•å¿«é€Ÿåœ°ä»¥ <code>O(1)</code> å¸¸æ•¸æ™‚é–“ç”¨ç´¢å¼•å®Œæˆï¼Œä¾‹å¦‚ä»¥ <code>my_text[3]</code> å–å¾—ç¬¬ 4 å€‹å…ƒ)ã€‚å–è€Œä»£ä¹‹çš„æ˜¯å¿…å®šå¾—è¿­ä»£æ•´å€‹ <code>utf-8</code> ä½å…ƒåºåˆ—ï¼Œæ‰æœ‰è¾¦æ³•çŸ¥é“å„å€‹ char çš„é–‹å§‹é»ï¼Œæ‰€ä»¥æ˜¯ <code>O(n)</code> ç·šæ€§æ™‚é–“</p>
<h3 id="push-str-to-uppercase-to-lowercase-trim-replace-concat-join"><a href="#push-str-to-uppercase-to-lowercase-trim-replace-concat-join" class="headerlink" title="push_str, +, to_uppercase, to_lowercase, trim, replace, concat, join"></a>push_str, +, to_uppercase, to_lowercase, trim, replace, concat, join</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> helloworld <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    helloworld<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">" world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    helloworld <span class="token operator">=</span> helloworld <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> helloworld<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> helloworld<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> helloworld<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ‡é™¤ç©ºç™½</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> helloworld<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"taiwan"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> helloworld <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"!"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> abc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> helloworld<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>abc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hello world<span class="token operator">!</span>
HELLO WORLD<span class="token operator">!</span>
hello world<span class="token operator">!</span>
hello taiwan<span class="token operator">!</span>
hello world<span class="token operator">!</span>
a,b,c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="to-string-parse"><a href="#to-string-parse" class="headerlink" title="to_string, parse"></a>to_string, parse</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> a_string <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> a_string<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} {}"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="format"><a href="#format" class="headerlink" title="format!"></a>format!</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// =&gt; "Hello"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Hello, {}!"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// =&gt; "Hello, world!"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"The number is {}"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// =&gt; "The number is 1"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// =&gt; "(3, 4)"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{value}"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// =&gt; "4"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{} {}"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// =&gt; "1 2"</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{:04}"</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// =&gt; "0042" with leading zeros</span>
<span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{:#?}"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// =&gt; "(</span>
                                  <span class="token comment">//       100,</span>
                                  <span class="token comment">//       200,</span>
                                  <span class="token comment">//     )"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/fmt/">moreâ€¦</a></p>
<h3 id="include-str"><a href="#include-str" class="headerlink" title="include_str"></a>include_str</h3><p>å¦‚æœä½ æœ‰ä¸€äº›éå¸¸é•·çš„æ–‡å­—ï¼Œå¯ä»¥è€ƒæ…®ä½¿ç”¨ marco <code>include_str!</code> å°‡ string å¾ file è®€åˆ°ç¨‹å¼è£¡</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> hello_html <span class="token operator">=</span> <span class="token macro property">include_str!</span><span class="token punctuation">(</span><span class="token string">"hello.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="chars"><a href="#chars" class="headerlink" title="chars"></a>chars</h3><p>Rust æä¾›äº†ä¸€å€‹æ–¹æ³•å¯ä»¥å–å¾—ä¸€å€‹ <code>utf-8</code> ä½å…ƒçµ„çš„å­—å…ƒå‘é‡ï¼Œå®ƒçš„å‹åˆ¥æ˜¯ <code>char</code>ã€‚ä¸€å€‹ <code>char</code> çš„å¤§å°æ°¸é æ˜¯ 4 bytes</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// collect the characters as a vector of char</span>
    <span class="token keyword">let</span> chars <span class="token operator">=</span> <span class="token string">"hi ğŸ¦€"</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> chars<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// should be 4</span>
    <span class="token comment">// since chars are 4 bytes we can convert to u32</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> chars<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>string</code> çš„ <code>chars()</code> æ–¹æ³•å°‡ string åˆ†é›¢ç‚ºå„å€‹æœ‰æ„ç¾©çš„ characterï¼Œä¸¦æ”¾å…¥ç©ºé–“ä¸€å¾‹ç‚º 4 bytes çš„ <code>char</code> å‹åˆ¥ä¸­ï¼Œä¸²æˆä¸€å€‹ <code>Vec</code> å›å‚³ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">for</span> c <span class="token keyword">in</span> my_str<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token comment">// do something with `c`</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">in</span> my_str<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with character `c` and index `i`</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Collections-Vector"><a href="#Collections-Vector" class="headerlink" title="Collections- Vector"></a>Collections- Vector</h2><ul>
<li>can only store values of the same type</li>
<li>puts all the values next to each other in memory</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Iterators can be collected into vectors</span>
    <span class="token keyword">let</span> collected_iterator<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Collected (0..10) into: {:?}"</span><span class="token punctuation">,</span> collected_iterator<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// The `vec!` macro can be used to initialize a vector</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> xs <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Initial vector: {:?}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Insert new element at the end of the vector</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Push 4 into the vector"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Vector: {:?}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Error! Immutable vectors can't grow</span>
    collected_iterator<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// FIXME ^ Comment out this line</span>

    <span class="token comment">// The `len` method yields the number of elements currently stored in a vector</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Vector length: {}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Indexing is done using the square brackets (indexing starts at 0)</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Second element: {}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// `pop` removes the last element from the vector and returns it</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Pop last element: {:?}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Out of bounds indexing yields a panic</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Fourth element: {}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// FIXME ^ Comment out this line</span>

    <span class="token comment">// `Vector`s can be easily iterated over</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Contents of xs:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> xs<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"&gt; {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// A `Vector` can also be iterated over while the iteration</span>
    <span class="token comment">// count is enumerated in a separate variable (`i`)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token keyword">in</span> xs<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"In position {} we have value {}"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Thanks to `iter_mut`, mutable `Vector`s can also be iterated</span>
    <span class="token comment">// over in a way that allows modifying each value</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> xs<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>x <span class="token operator">*=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Updated vector: {:?}"</span><span class="token punctuation">,</span> xs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Collections-HashMap"><a href="#Collections-HashMap" class="headerlink" title="Collections- HashMap"></a>Collections- HashMap</h2><p>All of the keys must have the same type, and all of the values must have the same type. Any type that implements the <code>Eq</code> and <code>Hash</code> traits can be a key in HashMap. This includes:</p>
<ul>
<li><code>bool</code> (though not very useful since there is only two possible keys)</li>
<li><code>int</code>, <code>uint</code>, and all variations thereof</li>
<li><code>String</code> and <code>&amp;str</code></li>
<li>You can easily implement Eq and Hash for a custom type with just one line: <code>#[derive(PartialEq, Eq, Hash)]</code></li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token keyword">mut</span> scores <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// `HashMap::insert()` returns `None`</span>
<span class="token comment">// if the inserted value is new, `Some(value)` otherwise</span>
scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> team_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> score <span class="token operator">=</span> scores<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>team_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

scores<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Yellow"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Only Inserting a Value If the Key Has No Value</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">&amp;</span>scores <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}: {}"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

contacts<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token string">"Yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">let</span> teams <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Yellow"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> initial_scores <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> scores<span class="token punctuation">:</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>_<span class="token punctuation">,</span> _<span class="token operator">&gt;</span> <span class="token operator">=</span>
    teams<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>initial_scores<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// `HashMap::iter()` returns an iterator that yields </span>
<span class="token comment">// (&amp;'a key, &amp;'a value) pairs in arbitrary order.</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token operator">&amp;</span>number<span class="token punctuation">)</span> <span class="token keyword">in</span> teams<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Calling {}: {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token function">call</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h3><p>Consider a HashSet as a HashMap where we just care about the keys ( <code>HashSet&lt;T&gt;</code> is, in actuality, just a wrapper around <code>HashMap&lt;T, ()&gt;</code>).<br>A HashSetâ€™s unique feature is that it is guaranteed to not have duplicate elements. Thatâ€™s the contract that any set collection fulfills. HashSet is just one implementation.</p>
<hr>
<h2 id="Trait"><a href="#Trait" class="headerlink" title="Trait"></a>Trait</h2><ul>
<li>å¯ç†è§£ç‚ºå…¶ä»–èªè¨€ï¼ˆå¦‚ pythonï¼‰çš„ <code>Interface</code></li>
<li>Trait è£¡é¢çš„ method å¯ä»¥æœ‰ default å¯¦ä½œï¼Œä½†ä»–ç„¡æ³•æ“ä½œ struct çš„ inner fieldsï¼Œä¹Ÿå°±æ˜¯èªªä¸€å€‹ trait åªèƒ½å®šç¾©éœ€è¦æœ‰å“ªäº› methodï¼Œç„¡æ³•å®šç¾©éœ€è¦æœ‰å“ªäº›æˆå“¡</li>
<li>trait å¯ä»¥ç¹¼æ‰¿å¦ä¸€å€‹ trait (<code>Supertraits</code>)ï¼š<code>trait LoudNoiseMaker: NoiseMaker</code>ã€‚ä»£è¡¨ <code>LoudNoiseMaker</code> ä¹Ÿè¦æœ‰ <code>NoiseMaker</code> è¦ç¯„çš„æ‰€æœ‰ method</li>
</ul>
<h3 id="Handling-Unsized-Data"><a href="#Handling-Unsized-Data" class="headerlink" title="Handling Unsized Data"></a>Handling Unsized Data</h3><p>When we want to store them within another struct, traits obfuscate the original struct thus it also obfuscates the original size. Unsized values being stored in structs are handled in two ways in Rust:</p>
<ul>
<li>generics - Using parameterized types effectively create struct/functions known types and thus known sizes. å³ä½¿ç”¨ <code>impl Trait</code></li>
<li>indirection - Putting instances on the heap gives us a level of indirection that allow us to not have to worry about the size of the actual type and just store a pointer to it. å³ä½¿ç”¨ <code>Box&lt;dyn Trait&gt;</code></li>
</ul>
<h3 id="Trait-bound-a-k-a-impl-Trait"><a href="#Trait-bound-a-k-a-impl-Trait" class="headerlink" title="Trait bound (a.k.a. impl Trait)"></a>Trait bound (a.k.a. impl Trait)</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">animal_talk</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token keyword">impl</span> <span class="token class-name">Animal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* same as
fn animal_talk&lt;T&gt;(a: T)
where
    T: Animal
{
  a.talk();
}
*/</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token class-name">Cat</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
  <span class="token function">animal_talk</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">animal_talk</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>impl Animal</code> There is no <code>&amp;</code> there. <code>impl</code> here makes the compiler determine the type at the compile time. One that takes Dog and another that takes Cat. This is called monomorphization and will not have any runtime overhead.</p>
<p>For example,</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">animal</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_dog_available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">Cat</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>It fails! because, the types here are determined at the compile time (static dispatch) . </p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Animal</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_dog_available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Dog</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> 
    
  <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Cat</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>This works!</p>
<h3 id="Static-vs-Dynamic-Dispatch-a-k-a-dyn-Trait"><a href="#Static-vs-Dynamic-Dispatch-a-k-a-dyn-Trait" class="headerlink" title="Static vs Dynamic Dispatch (a.k.a. dyn Trait)"></a>Static vs Dynamic Dispatch (a.k.a. dyn Trait)</h3><p><code>&amp;dyn NoiseMaker</code> is a <code>trait object</code>. It represents a pointer to the concrete type and a pointer to a vtable of function pointers. (<code>Box&lt;dyn Animal&gt;</code>, <code>Rc&lt;dyn Animal&gt;</code> are also trait Objects.) A <code>trait object</code> is what allows us to indirectly call the correct methods of an instance. A <code>trait object</code> is a struct that holds the pointer of our instance with a <code>list</code> of function pointers to our instanceâ€™s methods. This <code>list</code> of functions is known in <code>C++</code> as a <code>vtable</code>.</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">SeaCreature</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    noise<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">get_sound</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>noise
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token type-definition class-name">NoiseMaker</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make_noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">NoiseMaker</span> <span class="token keyword">for</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make_noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">get_sound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">static_make_noise</span><span class="token punctuation">(</span>creature<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">SeaCreature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// we know the real type</span>
    creature<span class="token punctuation">.</span><span class="token function">make_noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">dynamic_make_noise</span><span class="token punctuation">(</span>noise_maker<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">dyn</span> <span class="token class-name">NoiseMaker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// we don't know the real type</span>
    noise_maker<span class="token punctuation">.</span><span class="token function">make_noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> creature <span class="token operator">=</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Ferris"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        noise<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"blub"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">static_make_noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>creature<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dynamic_make_noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>creature<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Dynamic dispatch is slightly slower because of the pointer chasing to find the real function call.</p>
<h3 id="Derive"><a href="#Derive" class="headerlink" title="Derive"></a>Derive</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(PartialEq, PartialOrd)]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®“ç·¨è­¯å™¨è‡ªå‹•å¹«å¿™è£œä¸Šä¸€äº›åŸºæœ¬çš„ traitï¼Œå¦‚ä¸‹</p>
<ul>
<li>Comparison traits: <code>Eq</code>, <code>PartialEq</code>, <code>Ord</code>, <code>PartialOrd</code>.</li>
<li><code>Clone</code>, to create <code>T</code> from <code>&amp;T</code> via a copy. Introduce <code>.clone().</code></li>
<li><code>Copy</code>, to give a type â€˜copy semanticsâ€™ instead of â€˜move semanticsâ€™. Introct <code>.copy()</code>.</li>
<li><code>Hash</code>, to compute a hash from <code>&amp;T</code>.</li>
<li><code>Default</code>, to create an empty instance of a data type.</li>
<li><code>Debug</code>, to format a value using the <code>{:?}</code> formatter.</li>
<li><code>Add</code>, <code>Sub</code>, inctoduce <code>+</code>, <code>-</code> operators. </li>
<li><code>Drop</code>, you can override <code>.drop()</code></li>
<li><code>Iterator</code></li>
</ul>
<hr>
<h2 id="Rc-Arc-Refcell-Mutex"><a href="#Rc-Arc-Refcell-Mutex" class="headerlink" title="Rc, Arc, Refcell, Mutex"></a>Rc, Arc, Refcell, Mutex</h2><p><code>Rc</code>. Reference Count. ç”¨ä¾†è£ä¸€å€‹ (smart) pointerï¼Œå¦‚æ­¤ä¾¿æä¾›äº† <code>clone()</code> çš„èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯å…©å€‹ä¸åŒçš„ pointer æŒ‡å‘åŒä¸€å¡Šè³‡æ–™ã€‚<br>(<a target="_blank" rel="noopener" href="https://tourofrust.com/95_zh-tw.html">ç‚ºä»€éº¼å« smart pointer å¯ä»¥åƒè€ƒé€™è£</a>)<br>ç‚ºä»€éº¼éœ€è¦é€™å€‹ï¼Ÿè¨˜å¾— Rust çš„ç†å¿µï¼Œownership åŸºæœ¬ä¸Šåªæœ‰ä¸€å€‹ï¼Œæ‰€ä»¥ä¸æ˜¯ move å°±æ˜¯ borrowï¼Œå¦‚æœä¸æ˜¯ move ä¹Ÿä¸æ˜¯ borrowï¼Œé‚£åªèƒ½ copyï¼Œé‚£å¯¦éš›ä¸Šå°±æ˜¯å…©å¡Šç¨ç«‹çš„è³‡æ–™è‡ªç„¶å¯ä»¥å„æœ‰å„çš„ ownershipã€‚è—‰ç”±å–®ä¸€æ“æœ‰è€…ï¼Œå°±å¯ä»¥é€éè©²æ“æœ‰è€…çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰ï¼Œåœ¨æ­£ç¢ºçš„æ™‚é–“åš drop å›æ”¶è¨˜æ†¶é«”ã€‚<br>ä½†è‹¥ç‰½æ‰¯åˆ°æŒ‡æ¨™ï¼Œå°±è®Šæˆè¦ç¢ºä¿å·²ç¶“æ²’æœ‰ä»»ä½•æŒ‡æ¨™æŒ‡åˆ°æŸä¸€å¡Šè³‡æ–™ï¼Œæ‰å¯ä»¥ dropï¼Œæ‰€ä»¥éœ€è¦å°å…¥ <code>Rc</code>ï¼Œåªè¦æ˜¯é€é Rc clone çš„æŒ‡æ¨™éƒ½æœƒè¢«è¨˜éŒ„ï¼Œç¢ºä¿åœ¨ count æ­¸é›¶æ™‚æ‰æŠŠè¨˜æ†¶é«”é‡‹æ”¾ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Pie</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Pie</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"tastes better on the heap!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> heap_pie <span class="token operator">=</span> <span class="token class-name">Rc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Pie</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> heap_pie2 <span class="token operator">=</span> heap_pie<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> heap_pie3 <span class="token operator">=</span> heap_pie2<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    heap_pie3<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    heap_pie2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    heap_pie<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// all reference count smart pointers are dropped now</span>
    <span class="token comment">// the heap data Pie finally deallocates</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Refcell</code> ç”¨ä¾†è£ä¸€å€‹ (smart) pointerï¼Œæä¾› borrow mutable/immutable references çš„èƒ½åŠ›ï¼Œå¥½è™•æ˜¯ <code>Refcell</code> è² è²¬ç¢ºä¿ <em>Only one mutable reference OR multiple immutable references, but not both!</em><br>ç‚ºä»€éº¼éœ€è¦é€™å€‹ï¼Ÿå› ç‚º <code>Rc</code> åªæä¾›äº†è¤‡è£½æŒ‡æ¨™çš„èƒ½åŠ›ï¼Œè®“æˆ‘å€‘å¯ä»¥æœ‰è¤‡æ•¸å€‹æŒ‡æ¨™æŒ‡å‘åŒä¸€å¡Šè³‡æ–™ï¼Œå› æ­¤ä¹Ÿè² è²¬ç¢ºä¿äº† drop è©²è³‡æ–™è¨˜æ†¶é«”çš„æ™‚æ©Ÿã€‚ä½†ä»–æ²’æœ‰ç¢ºä¿ mutablility çš„éƒ¨åˆ†ï¼ŒåŒæ™‚æœ‰å…©å€‹æ´»è‘—çš„ mutable references æŒ‡å‘åŒä¸€å¡Šè³‡æ–™æ˜¯å±éšªçš„ã€‚</p>
<p>å¦‚ä¸‹é¢é€™ä¾‹å­ï¼Œ<code>ferris</code> å’Œ <code>sarah</code> çš„ pie å…¶å¯¦æ˜¯æŒ‡å‘åŒä¸€å¡Šè³‡æ–™ï¼Œä¸¦éæ“æœ‰å„è‡ªçš„ pie</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token class-name">RefCell</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Pie</span> <span class="token punctuation">{</span>
    slices<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Pie</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eat_slice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} took a slice!"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>slices <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">SeaCreature</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    pie<span class="token punctuation">:</span> <span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">RefCell</span><span class="token operator">&lt;</span><span class="token class-name">Pie</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// use smart pointer to pie for a mutable borrow</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> p <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>pie<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// take a bite!</span>
        p<span class="token punctuation">.</span><span class="token function">eat_slice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pie <span class="token operator">=</span> <span class="token class-name">Rc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">RefCell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Pie</span> <span class="token punctuation">{</span> slices<span class="token punctuation">:</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ferris and sarah are given clones of smart pointer to pie</span>
    <span class="token keyword">let</span> ferris <span class="token operator">=</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"ferris"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        pie<span class="token punctuation">:</span> pie<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> sarah <span class="token operator">=</span> <span class="token class-name">SeaCreature</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sarah"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        pie<span class="token punctuation">:</span> pie<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    ferris<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sarah<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> p <span class="token operator">=</span> pie<span class="token punctuation">.</span><span class="token function">borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} slices left"</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>slices<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœèªªå…©å€‹ pointer æœƒç”±ä¸åŒçš„ thread æ“æœ‰ï¼Œ<code>Rc</code> å°±è¦æ›æˆä½¿ç”¨ <code>Arc</code></p>
<p>ä¸”å¦‚æœèªªæœƒè·¨ threadï¼Œ<code>Refcell</code> å°±è®Šæˆè¦ä½¿ç”¨ <code>Mutex</code>ã€‚æ‰€ä»¥ç¶“å¸¸çœ‹åˆ°çš„çµ„åˆå°±æ˜¯</p>
<ul>
<li>within thread: <code>Rc&lt;RefCell&lt;...&gt;&gt;</code></li>
<li>across thread: <code>Arc&lt;Mutex&lt;...&gt;&gt;</code></li>
</ul>
<p>æ­¤æ™‚å¯èƒ½æœƒç”¢ç”Ÿä¸€å€‹ç–‘å•ï¼Œåœ¨è·¨ thread ç‹€æ³ä¸‹æœ‰ data racing çš„é¢¨éšªé€™æˆ‘å€‘çŸ¥é“ï¼Œå› æ­¤éœ€è¦å°å…¥ Arc å’Œ Mutex åˆç†ï¼›ä½†è‹¥ç‚º single thread çš„ç‹€æ³ï¼Œéœ€è¦ Rc ä¾†çŸ¥é“ drop æ™‚æ©Ÿå¯ä»¥ç†è§£ï¼Œä¸éç‚ºä½•éœ€è¦ Refcellï¼Ÿæ—¢ç„¶åªæœ‰ single threadï¼Œæ€éº¼å¯èƒ½æœƒæœ‰åŒä¸€æ™‚é–“å­˜åœ¨å…©å€‹ mutable reference çš„ç‹€æ³ï¼Ÿ<br>æœƒæœ‰é€™å€‹ç–‘å•å¯èƒ½æ˜¯å¿½ç•¥äº† Rust ç•¢ç«Ÿé‚„æ˜¯ä¸€å€‹èˆ‡ C ç›¸åŒå±¤ç´šçš„èªè¨€ï¼Œä»–æ˜¯å¯ä»¥æä¾›è¨˜æ†¶é«”ä½å€ç­‰ç´šçš„æ“ä½œçš„ã€‚ä¹Ÿå°±æ˜¯èªªä½ å¯ä»¥æ‹¿åˆ°ä¸€å€‹ instance çš„ addressï¼Œä¸¦é€éè©² address å°è©² instance æ“ä½œã€‚å•é¡Œæ˜¯ï¼Œè‹¥é€éé€™æ¨£çš„æ–¹å¼ï¼Œé€™äº›æ“ä½œå°±æ˜¯ä¸æ˜¯ compiler å¯ä»¥è¿½è¹¤åˆ°ä¸¦ä¸”ä»‹å…¥è¦ç¯„çš„ï¼Œè‡ªç”±ç•¶ç„¶æ˜¯è‡ªç”±ï¼Œä½†é¢¨éšªå°±è¦è‡ªè² ã€‚é€™ç¨®æ“ä½œåœ¨ Rust å«åš <code>Unsafe</code>ï¼Œæ¯”å¦‚ dereferencing a raw pointer æ“ä½œï¼Œåªè¦ç”¨ <code>Unsafe</code> block åŒ…èµ·ä¾†ï¼ŒRust compiler å°±æœƒä¸ç®¡ä½ è£¡é¢çš„æ“ä½œã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘å€‘å°æ–¼ pointer é€™ç¨®é€éæŒ‡æ¨™å»æ“ä½œä¸€å¡Šè³‡æ–™çš„è¡Œç‚ºï¼Œéƒ½é€é <code>Rc</code>, <code>RefCell</code> é€™ç¨® wrapperï¼Œé‚£å°±å¯ä»¥è®“ compiler ä»‹å…¥å¹«æˆ‘å€‘ç¢ºä¿æˆ‘å€‘å°æ–¼æŒ‡æ¨™çš„ä½¿ç”¨å®‰å…¨ï¼Œé †å¸¶ä¸€æï¼Œå¯ä»¥æƒ³è¦‹é€™å€‹ wrapper çš„å…§éƒ¨å¯¦ä½œçµ‚ç©¶é‚„æ˜¯æœƒæœ‰ Unsafe blockï¼Œåªæ˜¯èªªä»–åœ¨å¤–åŒ…äº†ä¸€å±¤ï¼ŒåŠ å…¥äº†ä¸€äº› metadataï¼Œè®“ç·¨è­¯å™¨å¯ä»¥è—‰ç”±é€™äº› metadata æ­¤ä¾†å¹«åŠ©æˆ‘å€‘è¿½è¹¤å’Œç¢ºä¿ã€‚</p>
<h2 id="Conversion"><a href="#Conversion" class="headerlink" title="Conversion"></a>Conversion</h2><p>é€é impl <code>From</code> æˆ– <code>Into</code> é€™å…©å€‹ traitsï¼Œå¯ä»¥è®“ä½ çš„ type æ“æœ‰ <code>::from()</code> æˆ– <code>::into()</code> çš„æ–¹æ³•ä¾†åšå‹åˆ¥è½‰æ›</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">From</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Number</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">From</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Number</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">from</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token class-name">Number</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> item <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token class-name">Number</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My number is {:?}"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">From</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Number</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">From</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Number</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">from</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token class-name">Number</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> item <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> int <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token comment">// Try removing the type declaration</span>
    <span class="token keyword">let</span> num<span class="token punctuation">:</span> <span class="token class-name">Number</span> <span class="token operator">=</span> int<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My number is {:?}"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>TryFrom</code>/<code>TryInto</code> traits are used for fallible conversions, and as such, return Results.</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">TryFrom</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">TryInto</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">EvenNumber</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">TryFrom</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">EvenNumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token type-definition class-name">Error</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">try_from</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">EvenNumber</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TryFrom</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token class-name">EvenNumber</span><span class="token punctuation">::</span><span class="token function">try_from</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">EvenNumber</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token class-name">EvenNumber</span><span class="token punctuation">::</span><span class="token function">try_from</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// TryInto</span>

    <span class="token keyword">let</span> result<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">EvenNumber</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token number">8i32</span><span class="token punctuation">.</span><span class="token function">try_into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">EvenNumber</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">EvenNumber</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token number">5i32</span><span class="token punctuation">.</span><span class="token function">try_into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><h3 id="print-Display"><a href="#print-Display" class="headerlink" title="print Display"></a>print Display</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span> <span class="token comment">// Import the `fmt` module.</span>

<span class="token comment">// Define a structure named `List` containing a `Vec`.</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">List</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">List</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token comment">// Extract the value using tuple indexing,</span>
        <span class="token comment">// and create a reference to `vec`.</span>
        <span class="token keyword">let</span> vec <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"["</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

        <span class="token comment">// Iterate over `v` in `vec` while enumerating the iteration</span>
        <span class="token comment">// count in `count`.</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>count<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">in</span> vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// For every element except the first, add a comma.</span>
            <span class="token comment">// Use the ? operator to return on errors.</span>
            <span class="token keyword">if</span> count <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span> <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{}"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Close the opened bracket and return a fmt::Result value.</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"]"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><ul>
<li>ä¸€å€‹ <em>Program</em> æœ‰ä¸€å€‹ <code>main.rs</code>ï¼Œè£¡é¢å¯¦ä½œ <code>main()</code> æ–¹æ³•</li>
<li>ä¸€å€‹ <em>Lib</em> æœ‰ä¸€å€‹ root module <code>lib.rs</code>ï¼Œå¯ä»¥å†åŒ…å«æ•¸å€‹ module ä½œç‚º submodule</li>
<li><em>Program</em> æˆ–è€… <em>Lib</em> éƒ½ç¨±ç‚ºä¸€å€‹ <em>crate</em>ï¼Œæ˜¯ä¸€å€‹ compilation unitï¼Œä¹Ÿå¯ä»¥å°æ‡‰åˆ°å…¶ä»–èªè¨€ package çš„æ¦‚å¿µï¼Œæ˜¯ä¸€å€‹å°å…¥ç¬¬ä¸‰æ–¹å‡½å¼åº«çš„å–®ä½ï¼Œé€é <code>use</code> ä¾†å°å…¥ namespace</li>
<li>ä¸€å€‹ <em>(Sub)Module</em> æœ‰å…©å€‹æ–¹å¼ï¼Œå–æ±ºæ–¼ code å¤§å°ï¼Œæ¯”å¦‚å‰µä¸€å€‹ submodule foo<ul>
<li><code>./foo.rs</code>ï¼šæ‰€æœ‰è©² foo module çš„ code éƒ½åœ¨é€™å€‹ rs file è£¡</li>
<li><code>./foo/mod.rs</code>ï¼šfoo é€™å€‹è³‡æ–™å¤¾åº•ä¸‹é‚„å¯ä»¥æœ‰å…¶ä»– rs fileï¼Œä»–å€‘åˆèµ·ä¾†å®Œæ•´ foo é€™å€‹ module</li>
</ul>
</li>
<li>access ä¸€å€‹ (sub)module èˆ‡ file path å¼·ç›¸é—œï¼Œä¸¦ä¸”æœ‰ä¸‰å€‹é—œéµå­—å¯ä½œç‚ºèµ·é»<ul>
<li><code>crate</code> - the root module of your crate</li>
<li><code>super</code> - the parent module of your current module</li>
<li><code>self</code> - the current module</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥ä¸€å€‹ crate å¯èƒ½å°±é•·é€™æ¨£</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”œâ”€â”€ lib.rs
â”œâ”€â”€ main.rs
â”œâ”€â”€ submod1.rs
â””â”€â”€ submod2
    â”œâ”€â”€ file1.rs
    â”œâ”€â”€ file2.rs
    â”œâ”€â”€ mod.rs
    â””â”€â”€ submod3
        â”œâ”€â”€ file3.rs
        â””â”€â”€ mod.rs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™¤äº† file å±¤ç´šçš„ module åŠƒåˆ†ï¼Œå–®ä¸€ rs è£¡é¢ä¹Ÿå¯ä»¥ç”¨ <code>mod</code> å®šç¾©è‡ªå·±çš„ submodule </p>
<h3 id="share-lib"><a href="#share-lib" class="headerlink" title="share lib"></a>share lib</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ rustc --crate-type<span class="token operator">=</span>lib rary.rs
$ <span class="token function">ls</span> lib*
library.rlib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>rary</code> is actuaylly refer to the whole acssociated <code>crate</code>. It does not imply only build single <code>rary.rs</code> file.</p>
<p>To using a Library</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// extern crate rary; // May be required for Rust 2015 edition or earlier</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token namespace">rary<span class="token punctuation">::</span></span><span class="token function">public_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h2><p><code>Option</code> å’Œ <code>Result</code> éƒ½æœ‰ <code>unwrap()</code> å’Œ <code>?</code> å¯ä»¥ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸Šä¸€å€‹ function çš„ return å€¼å»ºè­°å°±æ˜¯å¾é€™å…©è€…é¸å…¶ä¸€ï¼Œä¸¦ä¸”ä¸å»ºè­° caller ç›´æ¥ä½¿ç”¨ <code>unwarp()</code> è™•ç†ï¼Œå› ç‚ºé€™æœƒé€ æˆ <code>panic</code></p>
<h3 id="Option"><a href="#Option" class="headerlink" title="Option"></a>Option</h3><p><code>map()</code> æ˜¯ <code>Option</code> æä¾›çš„æ–¹æ³•ï¼Œåƒæ•¸æ˜¯ä¸€å€‹ <code>closure</code>ï¼Œä»–å…¶å¯¦å°±æ˜¯åœ¨é€™ç¨®æƒ…å¢ƒä¸­ match èªæ³•çš„ç°¡åŒ–ï¼Œå¦‚ä¸‹ç¯„ä¾‹</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// Chopping food. If there isn't any, then return `None`.</span>
<span class="token comment">// Otherwise, return the chopped food.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">chop</span><span class="token punctuation">(</span>peeled<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Peeled</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Chopped</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> peeled <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">Peeled</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">Chopped</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">None</span>               <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Cooking food. Here, we showcase `map()` instead of `match` for case handling.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">cook</span><span class="token punctuation">(</span>chopped<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Chopped</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Cooked</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    chopped<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token class-name">Chopped</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">Cooked</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/* instead of
fn cook(chopped: Option&lt;Chopped&gt;) -&gt; Option&lt;Cooked&gt; {
    match chopped {
        Some(Chopped(food)) =&gt; Some(Cooked(food)),
        None =&gt; None
    }
}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä¸²å…©çš„éƒ½æ˜¯ return Option çš„ function çš„æ™‚å€™ï¼Œå¦‚æœå…©å€‹ function çš„ return Option&lt;Type&gt; ç›¸åŒï¼Œé‚£å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>?</code>ï¼›è‹¥ä¸åŒï¼Œå‰‡è¦åšè½‰æ›ï¼Œä½†æ‡‰æ›æˆä½¿ç”¨ <code>Option</code> çš„ <code>and_then()</code> æ–¹æ³•ï¼Œå› ç‚ºè‹¥ä½¿ç”¨ <code>map()</code>ï¼Œæœƒå¤šä¸€å±¤ Optionï¼Œå› ç‚º <code>map()</code> åŒ…å«ä¸€å€‹ç°¡åŒ–æ˜¯æœƒå¹«ä½ åŠ ä¸Š <code>Some()</code> è£èµ·ä¾†</p>
<p>ä¸‹é¢é€™å€‹ç¯„ä¾‹å°±æ˜¯ä¸² <code>have_recipe()</code> å’Œ <code>have_ingredients()</code> å…©å€‹ function</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug, Clone)]</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Food</span> <span class="token punctuation">{</span> <span class="token class-name">CordonBleu</span><span class="token punctuation">,</span> <span class="token class-name">Steak</span><span class="token punctuation">,</span> <span class="token class-name">Sushi</span> <span class="token punctuation">}</span>
<span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Day</span> <span class="token punctuation">{</span> <span class="token class-name">Monday</span><span class="token punctuation">,</span> <span class="token class-name">Tuesday</span><span class="token punctuation">,</span> <span class="token class-name">Wednesday</span> <span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">have_ingredients</span><span class="token punctuation">(</span>food<span class="token punctuation">:</span> <span class="token class-name">Food</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Food</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> food <span class="token punctuation">{</span>
        <span class="token class-name">Food</span><span class="token punctuation">::</span><span class="token class-name">Sushi</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        _           <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">have_recipe</span><span class="token punctuation">(</span>food<span class="token punctuation">:</span> <span class="token class-name">Food</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Food</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> food <span class="token punctuation">{</span>
        <span class="token class-name">Food</span><span class="token punctuation">::</span><span class="token class-name">CordonBleu</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        _                <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">cookable_v2</span><span class="token punctuation">(</span>food<span class="token punctuation">:</span> <span class="token class-name">Food</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Food</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">have_recipe</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span>have_ingredients<span class="token punctuation">)</span>
    <span class="token comment">// instead of have_recipe(food).map(|f| have_ingredients(f))</span>
    <span class="token comment">//   becauset his will return Option&lt;Option&lt;Food&gt;&gt;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="as-ref-as-mut"><a href="#as-ref-as-mut" class="headerlink" title="as_ref(), as_mut()"></a>as_ref(), as_mut()</h4><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">const</span> <span class="token keyword">fn</span> <span class="token function-definition function">as_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Converts from <code>&amp;Option&lt;T&gt;</code> to <code>Option&lt;&amp;T&gt;</code>.</p>
<p>é€™æ±è¥¿çš„é‡è¦æ€§åœ¨æ–¼å¯ä»¥ç”¢ç”Ÿä¸€å€‹è¢«åŒ…åœ¨ Option è£¡é¢çš„æ±è¥¿çš„ reference è€Œä¸ç”¨ take ownership</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">as_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Converts from <code>&amp;mut Option&lt;T&gt;</code> to <code>Option&lt;&amp;mut T&gt;</code>.</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">match</span> x<span class="token punctuation">.</span><span class="token function">as_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">*</span>v <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ³¨æ„è½‰æ›éä¹‹å¾Œéƒ½é‚„æ˜¯åŒ…åœ¨ <code>Option</code> è£¡é¢</p>
<blockquote>
<p><code>Option</code>, <code>Box</code>, <code>Result</code> ä¸‰ç¨®é¡å‹æ‰æœ‰æ”¯æŒé è¨­ï¼Œå…¶ä»–è¦å¯¦ä½œ <code>AsRef</code> trait</p>
</blockquote>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> a <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> p1 <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// p æ²’æœ‰ take ownership å–”. 5 çš„ ownership é‚„æ˜¯åœ¨ a</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> p11 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"p11:{:?}"</span><span class="token punctuation">,</span> p11<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯ä»¥é€é p11 æ‹¿åˆ° 5</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"a:{:?}"</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// ä»¥ä¸‹æ˜¯çŠ¯ä¸€äº›å¦‚æœä¸ä½¿ç”¨ as_ref()ï¼Œæœƒé‡åˆ°çš„ ownership å•é¡Œ</span>
    
    <span class="token keyword">let</span> p2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> a<span class="token punctuation">;</span>
    <span class="token comment">//let p22 = p2.unwrap(); // cannot move out of `*p2` which is behind a shared reference</span>

    <span class="token comment">/*let p22 = match *p2 { // cannot move out of `p2.0` which is behind a mutable reference
        Some(v) =&gt; *v, // v: data moved here
        None =&gt; 0
    };*/</span>
    
    <span class="token keyword">let</span> p22 <span class="token operator">=</span> <span class="token keyword">match</span> <span class="token operator">*</span>p2 <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token keyword">ref</span> v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">*</span><span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token comment">// è™•ç†ä¸Šé¢éŒ¯èª¤çš„æ–¹æ³•å°±æ˜¯ç”¨ ref ä¾†æ¥</span>
        <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"p22:{:?} {:p}"</span><span class="token punctuation">,</span> p22<span class="token punctuation">,</span> <span class="token operator">&amp;</span>p22<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//println!("a:{:?}", a); // cannot borrow `a` as immutable because it is also borrowed as mutable</span>
    <span class="token comment">// é€™å€‹æ™‚å€™ 5 çš„ ownership éƒ½é‚„æ˜¯åœ¨ aï¼Œæ‰€ä»¥ç•¶é€™è£¡è¦ç”¨ a å°±æœƒæœ‰é€™å€‹è¡çª</span>

    <span class="token keyword">let</span> p23 <span class="token operator">=</span> <span class="token keyword">match</span> p2<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æˆ–è€…è¦æŠŠåŸæœ¬ a çš„ ownership take éä¾†åˆ° p2ï¼Œp2 æ‰æœ‰æ¬ŠæŠŠè£¡é¢çš„æ±è¥¿ç§»å» v</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">*</span>v<span class="token punctuation">,</span>
        <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"p23:{:?} {:p}"</span><span class="token punctuation">,</span> p23<span class="token punctuation">,</span> <span class="token operator">&amp;</span>p23<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"a:{:?}"</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å› ç‚ºåŸæœ¬ a çš„ ownership å·²ç¶“è¢«è½‰ç§»å» p2ï¼Œæ‰€ä»¥ a å·²ç¶“è®Š None è‡ªç„¶ä¹Ÿä¸å†æœ‰è¡çª</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>å°æ–¼ä¸€å€‹ module è€Œè¨€ï¼Œæœ€å®Œæ•´çš„ erro propagation åšæ³•ç‚º</p>
<ol>
<li>å®šç¾©è‡ªå·±çš„ error å‹åˆ¥ï¼Œæ¯”å¦‚ <code>enum MyError {}</code>ï¼Œåˆ—èˆ‰å„ç¨®å¯èƒ½ç”¢ç”Ÿçš„ errorï¼ŒåŒæ™‚ä¹ŸåŒ…å«ç•¶ä½¿ç”¨åˆ°å…¶ä»– module æ™‚ï¼Œå„å€‹å…¶ä»– moduel çš„ error æ­¸é¡åˆ° MyError ä¸­çš„å…¶ä¸­ä¸€å€‹å¯èƒ½å€¼</li>
<li><code>impl fmt::Display for MyError</code></li>
<li><code>impl error::Error for MyError</code> å¯¦ä½œ <code>source()</code> æ–¹æ³•ï¼Œ<code>source()</code> æ–¹æ³•ä½¿è·¨æŠ½è±¡å±¤çš„ç‹€æ³è®“ä¸Šå±¤ module ä¹Ÿèƒ½å–å¾—æ›´å¤šå…¶<em>ä¸‹ä¸‹å±¤</em> module çš„ error ç´°ç¯€çš„å¯èƒ½æ€§ã€‚ä¹Ÿå°±æ˜¯èªªï¼Œé€™ä¸€æ­¥å¯ä»¥ä¸åšï¼Œä½†ä¸åšçš„çµæœå°±æ˜¯ï¼Œå‡è¨­ æŸA ä½¿ç”¨ä½ çš„ moduleï¼Œç•¶ä½ çš„ module ç™¼ç”Ÿäº† call å¦ä¸€å€‹ moduleB æ™‚ç”¢ç”Ÿçš„è©² moduleB çš„ error å› æ­¤å°è‡´ä½ çš„ moduel ä¹Ÿ report error çµ¦ æŸAï¼ŒæŸA æ‰€èƒ½å¾—åˆ°çš„å”¯ä¸€è³‡è¨Šå°±æ˜¯ä½ ç¿»è­¯éçš„ errorï¼Œç„¡æ³•é€²ä¸€æ­¥é€é source() é€²åˆ° moduleB è£¡å»æå–æ›´å¤šè³‡è¨Š</li>
<li><code>impl From&lt;OtherModuleErrorType&gt; for MyError</code> è®“ <code>?</code> å¯ç”¨ã€‚ä¹Ÿå¯ä»¥ä¸åšï¼Œè‹¥ä¸åšå°±è®Šæˆç•¶è¦ call å…¶ä»– module æ™‚ï¼Œè¦ç”¨ <code>method_provided_by_another_module().ok_or(MyError::SomeTranslatedError)?</code> ä¾†åšè½‰æ›ã€‚ç›¸ç•¶æ–¼ <code>?</code> å…¶å¯¦å°±æ˜¯æœƒå»æ‰¾ <code>From</code> æ–¹æ³•å­˜ä¸å­˜åœ¨ï¼Œè‹¥å­˜åœ¨å°±æœƒä¾æ“š From çš„å…§å®¹åšè½‰æ›</li>
</ol>
<p>ä¸‹é¢ç¯„ä¾‹</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">double_first</span><span class="token punctuation">(</span>vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Generate error 1</span>
    <span class="token number">2</span> <span class="token operator">*</span> first<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Generate error 2</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"42"</span><span class="token punctuation">,</span> <span class="token string">"93"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> empty <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"tofu"</span><span class="token punctuation">,</span> <span class="token string">"93"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The first doubled is {}"</span><span class="token punctuation">,</span> <span class="token function">double_first</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The first doubled is {}"</span><span class="token punctuation">,</span> <span class="token function">double_first</span><span class="token punctuation">(</span>empty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Error 1: the input vector is empty</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The first doubled is {}"</span><span class="token punctuation">,</span> <span class="token function">double_first</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Error 2: the element doesn't parse to a number</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‡è¨­é€™å°±æ˜¯æˆ‘å€‘çš„ moduleï¼Œè£¡é¢ç”¨äº†å…¶ä»–å…©å€‹ moduel çš„æ–¹æ³• <code>first()</code> å’Œ <code>parse()</code>ï¼Œä»–å€‘éƒ½æœƒç”¢ç”Ÿå„è‡ªå®šç¾©çš„ error typeã€‚ä¸‹é¢å°±æ˜¯ä¾æ“šä¸Šè¿°çš„æ­¥é©Ÿæ”¹å¯«çš„çµæœï¼Œæˆ‘å€‘å®šç¾©äº†è‡ªå·±çš„ error type <code>DoubleError</code> æŠŠä»–å€‘åŒ…èµ·ä¾†ä¸¦å€‹åˆ¥ç¿»è­¯</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>error<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">Error</span> <span class="token keyword">as</span> _<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token type-definition class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>result<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">DoubleError</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">DoubleError</span> <span class="token punctuation">{</span>
    <span class="token class-name">EmptyVec</span><span class="token punctuation">,</span>
    <span class="token comment">// We will defer to the parse error implementation for their error.</span>
    <span class="token comment">// Supplying extra info requires adding more data to the type.</span>
    <span class="token class-name">Parse</span><span class="token punctuation">(</span><span class="token class-name">ParseIntError</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">DoubleError</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>
            <span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">EmptyVec</span> <span class="token operator">=&gt;</span>
                <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"please use a vector with at least one element"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// The wrapped error contains additional information and is available</span>
            <span class="token comment">// via the source() method.</span>
            <span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">Parse</span><span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"the provided string could not be parsed as int"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">error<span class="token punctuation">::</span></span><span class="token class-name">Error</span> <span class="token keyword">for</span> <span class="token class-name">DoubleError</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">source</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">dyn</span> <span class="token namespace">error<span class="token punctuation">::</span></span><span class="token class-name">Error</span> <span class="token operator">+</span> <span class="token lifetime-annotation symbol">'static</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>
            <span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">EmptyVec</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            <span class="token comment">// The cause is the underlying implementation error type. Is implicitly</span>
            <span class="token comment">// cast to the trait object `&amp;error::Error`. This works because the</span>
            <span class="token comment">// underlying type already implements the `Error` trait.</span>
            <span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">Parse</span><span class="token punctuation">(</span><span class="token keyword">ref</span> e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Implement the conversion from `ParseIntError` to `DoubleError`.</span>
<span class="token comment">// This will be automatically called by `?` if a `ParseIntError`</span>
<span class="token comment">// needs to be converted into a `DoubleError`.</span>
<span class="token keyword">impl</span> <span class="token class-name">From</span><span class="token operator">&lt;</span><span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">DoubleError</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">from</span><span class="token punctuation">(</span>err<span class="token punctuation">:</span> <span class="token class-name">ParseIntError</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">DoubleError</span> <span class="token punctuation">{</span>
        <span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">Parse</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">double_first</span><span class="token punctuation">(</span>vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token class-name">DoubleError</span><span class="token punctuation">::</span><span class="token class-name">EmptyVec</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token comment">// Here we implicitly use the `ParseIntError` implementation of `From` (which</span>
    <span class="token comment">// we defined above) in order to create a `DoubleError`.</span>
    <span class="token keyword">let</span> parsed <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> parsed<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> result <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The first doubled is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"  Caused by: {}"</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"42"</span><span class="token punctuation">,</span> <span class="token string">"93"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> empty <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"tofu"</span><span class="token punctuation">,</span> <span class="token string">"93"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">double_first</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">double_first</span><span class="token punctuation">(</span>empty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">double_first</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Multithreading"><a href="#Multithreading" class="headerlink" title="Multithreading"></a>Multithreading</h2><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Sender</span><span class="token punctuation">,</span> <span class="token class-name">Receiver</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span>mpsc<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>thread<span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token constant">NTHREADS</span><span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Channels have two endpoints: the `Sender&lt;T&gt;` and the `Receiver&lt;T&gt;`,</span>
    <span class="token comment">// where `T` is the type of the message to be transferred</span>
    <span class="token comment">// (type annotation is superfluous)</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>tx<span class="token punctuation">,</span> rx<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Sender</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Receiver</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> children <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> id <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token constant">NTHREADS</span> <span class="token punctuation">{</span>
        <span class="token comment">// The sender endpoint can be copied</span>
        <span class="token keyword">let</span> thread_tx <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Each thread will send its id via the channel</span>
        <span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token namespace">thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token comment">// The thread takes ownership over `thread_tx`</span>
            <span class="token comment">// Each thread queues a message in the channel</span>
            thread_tx<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Sending is a non-blocking operation, the thread will continue</span>
            <span class="token comment">// immediately after sending its message</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"thread {} finished"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Here, all the messages are collected</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> ids <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token constant">NTHREADS</span> <span class="token keyword">as</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token constant">NTHREADS</span> <span class="token punctuation">{</span>
        <span class="token comment">// The `recv` method picks a message from the channel</span>
        <span class="token comment">// `recv` will block the current thread if there are no messages available</span>
        ids<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rx<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Wait for the threads to complete any remaining work</span>
    <span class="token keyword">for</span> child <span class="token keyword">in</span> children <span class="token punctuation">{</span>
        child<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"oops! the child thread panicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Show the order in which the messages were sent</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h2><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>process<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Command</span><span class="token punctuation">,</span> <span class="token class-name">Stdio</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token constant">PANGRAM</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token operator">=</span>
<span class="token string">"the quick brown fox jumped over the lazy dog\n"</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Spawn the `wc` command</span>
    <span class="token keyword">let</span> process <span class="token operator">=</span> <span class="token keyword">match</span> <span class="token class-name">Command</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"wc"</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token class-name">Stdio</span><span class="token punctuation">::</span><span class="token function">piped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">stdout</span><span class="token punctuation">(</span><span class="token class-name">Stdio</span><span class="token punctuation">::</span><span class="token function">piped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>why<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"couldn't spawn wc: {}"</span><span class="token punctuation">,</span> why<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> process<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Write a string to the `stdin` of `wc`.</span>
    <span class="token comment">//</span>
    <span class="token comment">// `stdin` has type `Option&lt;ChildStdin&gt;`, but since we know this instance</span>
    <span class="token comment">// must have one, we can directly `unwrap` it.</span>
    <span class="token keyword">match</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write_all</span><span class="token punctuation">(</span><span class="token constant">PANGRAM</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>why<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"couldn't write to wc stdin: {}"</span><span class="token punctuation">,</span> why<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"sent pangram to wc"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Because `stdin` does not live after the above calls, it is `drop`ed,</span>
    <span class="token comment">// and the pipe is closed.</span>
    <span class="token comment">//</span>
    <span class="token comment">// This is very important, otherwise `wc` wouldn't start processing the</span>
    <span class="token comment">// input we just sent.</span>

    <span class="token comment">// The `stdout` field also has type `Option&lt;ChildStdout&gt;` so must be unwrapped.</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>why<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"couldn't read wc stdout: {}"</span><span class="token punctuation">,</span> why<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"wc responded with:\n{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>If youâ€™d like to wait for a process::Child to finish, you must call Child::wait, which will return a <code>process::ExitStatus</code>.</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>process<span class="token punctuation">::</span></span><span class="token class-name">Command</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> child <span class="token operator">=</span> <span class="token class-name">Command</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"sleep"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> _result <span class="token operator">=</span> child<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"reached end of main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Argument-parsing"><a href="#Argument-parsing" class="headerlink" title="Argument parsing"></a>Argument parsing</h2><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>env<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">increase</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">decrease</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"usage:
match_args &lt;string&gt;
    Check whether given string is the answer.
match_args {{increase|decrease}} &lt;integer&gt;
    Increase or decrease given integer by one."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> args<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token namespace">env<span class="token punctuation">::</span></span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> args<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// no arguments passed</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My name is 'match_args'. Try passing some arguments!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// one argument passed</span>
        <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">match</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This is the answer!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This is not the answer."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// one command and one argument passed</span>
        <span class="token number">3</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> cmd <span class="token operator">=</span> <span class="token operator">&amp;</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token operator">&amp;</span>args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// parse the number</span>
            <span class="token keyword">let</span> number<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> <span class="token keyword">match</span> num<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    n
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token class-name">Err</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">"error: second argument not an integer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment">// parse the command</span>
            <span class="token keyword">match</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
                <span class="token string">"increase"</span> <span class="token operator">=&gt;</span> <span class="token function">increase</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"decrease"</span> <span class="token operator">=&gt;</span> <span class="token function">decrease</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">,</span>
                _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">"error: invalid command"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// all the other cases</span>
        _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// show a help message</span>
            <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://tourofrust.com/TOC_zh-tw.html">Rust èªè¨€ä¹‹æ—…</a></li>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/">Rust book</a></li>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/stable/rust-by-example/index.html">Rust by Example</a></li>
<li><a target="_blank" rel="noopener" href="https://cotigao.medium.com/dyn-impl-and-trait-objects-rust-fd7280521bea">dyn , impl and Trait Objects â€” Rust</a></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Chris Chung</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://chungchris.github.io/2021/06/30/software/language/rust-note/">https://chungchris.github.io/2021/06/30/software/language/rust-note/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Chris Chung</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/programming-language/">
                                    <span class="chip bg-color">programming language</span>
                                </a>
                            
                                <a href="/tags/rust/">
                                    <span class="chip bg-color">rust</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    
        <div class="disqus-card card" data-aos="fade-up">
    <div id="disqus_thread" class="card-content">
        <noscript>Please enable JavaScript to view the
            <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
    </div>
</div>

<script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://chungchris.github.io/2021/06/30/software/language/rust-note/';
        this.page.identifier = '/2021/06/30/software/language/rust-note/';
        this.page.title = 'Rust ç­†è¨˜';
    };
    let disqus_shortname = 'chungchris-ghp';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // å¦‚ï¼šs.src = 'https://blinkfox.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2021/07/06/software/language/go-note/">
                    <div class="card-image">
                        
                        <img src="https://drive.google.com/uc?export=view&id=1cviZ_5SNqD4q0VzzCoJ9eSRqicirTDsU" class="responsive-img" alt="Go ç­†è¨˜">
                        
                        <span class="card-title">Go ç­†è¨˜</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            ä¸€äº› Go çš„å­¸ç¿’è³‡æºæ•´ç†å’Œå€‹äººç­†è¨˜
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-07-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/software/" class="post-category">
                                    software
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/programming-language/">
                        <span class="chip bg-color">programming language</span>
                    </a>
                    
                    <a href="/tags/go/">
                        <span class="chip bg-color">go</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/06/21/software/data-structure/">
                    <div class="card-image">
                        
                        <img src="https://drive.google.com/uc?export=view&id=1G-wi-CFGZuZzkAoz_iyVyeUZSXIlKlKm" class="responsive-img" alt="åŸºç¤è³‡æ–™çµæ§‹æ¼”ç®—æ³•ç­†è¨˜">
                        
                        <span class="card-title">åŸºç¤è³‡æ–™çµæ§‹æ¼”ç®—æ³•ç­†è¨˜</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            è³‡æ–™çµæ§‹ã€æ’åºæ¼”ç®—æ³•ã€æœå°‹æ¼”ç®—æ³•
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/software/" class="post-category">
                                    software
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/sort/">
                        <span class="chip bg-color">sort</span>
                    </a>
                    
                    <a href="/tags/search/">
                        <span class="chip bg-color">search</span>
                    </a>
                    
                    <a href="/tags/%E6%BC%94%E7%AE%97%E6%B3%95/">
                        <span class="chip bg-color">æ¼”ç®—æ³•</span>
                    </a>
                    
                    <a href="/tags/%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B/">
                        <span class="chip bg-color">è³‡æ–™çµæ§‹</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: A Po<br />'
            + 'Author: Chris Chung<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + 'æœ¬æ–‡ç« æˆåŠŸæ¬Šæ­¸ä½œè€…æ‰€æœ‰ï¼Œå½¢å¼çš„è½‰è¼‰éƒ½è«‹è¨»æ˜å‡ºè™•ã€‚';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">Chris Chung</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;Total Words:&nbsp;<span
                        class="white-color">76.9k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/chungchris" class="tooltipped" target="_blank" data-tooltip="Visit my GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:imchungchris@@hotmail.com" class="tooltipped" target="_blank" data-tooltip="Wmail me" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="Subscribe RSS" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js?ver=202106210516"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
